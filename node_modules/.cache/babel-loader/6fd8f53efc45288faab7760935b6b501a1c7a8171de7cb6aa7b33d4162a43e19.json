{"ast":null,"code":"var _jsxFileName = \"/Users/dongwookang/Documents/internship/aes-test/src/App.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport mapboxgl from 'mapbox-gl';\nimport React, { useState, useEffect, useRef } from 'react';\nimport { ThemeProvider } from '@material-ui/core/styles';\nimport Hidden from '@material-ui/core/Hidden';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\nimport IconButton from '@material-ui/core/Button';\nimport { Home } from '@material-ui/icons';\nimport LogoOverlay from './LogoOverlay';\nimport Omnibox from './Omnibox';\nimport SettingsPane from './SettingsPane';\nimport { getAllCategories } from './common';\nimport CONFIG from './config.json';\nimport { fetchMapData } from './data-loader';\nimport { THEME } from './Theme';\nimport insightLogo from './img/insight-white.png';\nimport './App.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst COMPANIES_SOURCE = 'companies';\nconst MAPS = CONFIG['maps'];\nconst POINT_LAYER = 'energy-companies-point-layer';\n\n// mapboxgl.accessToken = process.env.REACT_APP_MAPBOX_API_TOKEN;\nmapboxgl.accessToken = 'pk.eyJ1IjoidG90b3JvLWRha2UiLCJhIjoiY2tiNzJuZmQ3MDFudDJxa2N1ZG91YzBzciJ9.5qJpYzti2W7avnuM9rCiKA';\n\n/** @return {html code for the popup } */\nfunction getPopupContent(props) {\n  const categoryInfo = ['tax1', 'tax2', 'tax3'].map(k => props[k]).filter(s => s).join(\", \");\n  var extraNotes = \"\";\n  if (props.hasOwnProperty(\"notes\") && props[\"notes\"] !== \"\") {\n    extraNotes = `Focus: <span>${props['notes']}</span><br />`;\n  }\n  return `\n    <div class=\"popup\" style = \"color: 626262\">\n      <h3 class=\"company-name\">\n        <a href=${props['website']} class=\"popup-link\" target=\"blank\">${props['company']}</a>\n      </h3>\n      Sector(s): <span class=\"category-info\">${categoryInfo}</span><br />\n      City: <span class=\"city-info\">${props['city']}</span><br />\n      ${extraNotes}\n    </div>`;\n}\nfunction clearPopups() {\n  // Check if there is already a popup on the map and if so, remove it\n  // This prevents multiple popups in the case of overlapping circles\n  var popUps = document.getElementsByClassName('mapboxgl-popup');\n  if (popUps[0]) popUps[0].remove();\n}\nfunction displayPopup(map, feature) {\n  // clears the open popup and creates the new one \n  const coordinates = feature.geometry.coordinates.slice();\n  clearPopups();\n  new mapboxgl.Popup({}).setLngLat(coordinates).setHTML(getPopupContent(feature.properties)).setMaxWidth(\"600px\").addTo(map);\n}\n//79ddf2 - color for hover\n\nfunction populateMapData(map, mapId, mapData) {\n  // adds the data to the map\n  // sets correct initial view of the map\n  console.log(\"map for debug: \");\n  console.log(map);\n  console.log(\"from populateMapData, mapId: \");\n  console.log(MAPS[mapId]);\n  map.setCenter(MAPS[mapId].center);\n  map.setZoom(6);\n  mapData.then(data => {\n    map.addSource(COMPANIES_SOURCE, {\n      type: 'geojson',\n      data: data['geojson']\n    });\n\n    // Last entry is fallthrough color\n    let circleColors = data['taxonomy'].map(c => [c.name, c.color]).flat().concat(['#ccc']);\n    map.addLayer({\n      id: POINT_LAYER,\n      type: 'circle',\n      source: COMPANIES_SOURCE,\n      interactive: true,\n      paint: {\n        // make circles larger as the user zooms\n        'circle-radius': {\n          stops: [[7, 5], [14, 12], [20, 50]]\n        },\n        'circle-opacity': 0.85,\n        // color circles by primary category\n        'circle-color': ['match', ['get', 'tax1']].concat(circleColors),\n        'circle-stroke-color': '#000',\n        'circle-stroke-width': 0.4\n      }\n    });\n    map.on('mouseenter', POINT_LAYER, e => {\n      map.getCanvas().style.cursor = 'pointer';\n    });\n    map.on('mouseleave', POINT_LAYER, () => {\n      map.getCanvas().style.cursor = '';\n    });\n    map.on('click', POINT_LAYER, e => displayPopup(map, e.features[0]));\n    map.flyTo({\n      center: MAPS[mapId].flyTo,\n      zoom: MAPS[mapId].flyToZoom || 8,\n      speed: 0.5\n    });\n  });\n}\nconst getUrlFragment = () => window.location.hash.replace('#', '');\nfunction useUrlFragment(fragment, callback) {\n  _s();\n  useEffect(() => {\n    window.location.hash = '#' + fragment;\n    const handleHashChange = () => {\n      callback(getUrlFragment());\n    };\n    window.addEventListener('hashchange', handleHashChange);\n    return () => {\n      window.removeEventListener('hashchange', handleHashChange);\n    };\n  });\n}\n\n/** @return {mapId} */\n_s(useUrlFragment, \"OD7bBpZva5O2jO+Puf00hKivP7c=\");\nfunction getInitialMapId() {\n  let initialMapId = getUrlFragment();\n  if (MAPS.hasOwnProperty(initialMapId)) {\n    return initialMapId;\n  }\n  return CONFIG['defaultMapId'];\n}\n\n// sets the styles for the material-ui components\nconst useStyles = makeStyles(theme => ({\n  root: {\n    display: 'flex',\n    flexDirection: 'row'\n  },\n  mainContent: {\n    flexGrow: 1,\n    position: 'relative'\n  },\n  mapContainer: {\n    height: '100vh',\n    top: 0,\n    right: 0,\n    left: 0,\n    bottom: 0,\n    backgroundColor: '#333'\n  },\n  mapOverlay: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    right: 0,\n    bottom: 0,\n    padding: 0,\n    pointerEvents: 'none'\n  },\n  mapOverlayInner: {\n    display: 'block',\n    position: 'relative',\n    height: '100%',\n    width: '100%',\n    margin: 0,\n    padding: 0\n  },\n  mainControlOverlay: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    padding: 0,\n    margin: 0,\n    pointerEvents: 'auto',\n    display: 'flex',\n    flexDirection: 'row'\n  },\n  mainControlOverlayShifted: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    padding: 0,\n    margin: 0,\n    pointerEvents: 'auto',\n    display: 'flex',\n    flexDirection: 'row',\n    marginLeft: 320\n  },\n  insightLogoContainer: {\n    padding: 8,\n    marginTop: 23,\n    marginLeft: 8\n  },\n  titleAndSearch: {\n    padding: '4px 8px'\n  },\n  mapTitle: {\n    color: '#fff',\n    padding: '4px 0px',\n    marginBottom: 4\n  },\n  resetViewButton: {\n    position: 'absolute',\n    bottom: 73,\n    right: 4.5,\n    minWidth: 30,\n    maxWidth: 30,\n    height: 31\n  }\n}));\n\n/** @return {html code for the app } */\nexport default function App() {\n  _s2();\n  const classes = useStyles();\n  const [thisMap, setThisMap] = useState(null);\n  const [selectedMapId, setSelectedMapId] = useState(getInitialMapId());\n  const [taxonomy, setTaxonomy] = useState([]);\n  const [companiesGeojson, setCompaniesGeojson] = useState({});\n  const [selectedCategories, setSelectedCategories] = useState(new Set([]));\n  const [mobileDrawerOpen, setMobileDrawerOpen] = useState(false);\n  function handleToggleCategory(e) {\n    // called when categories are individually changed\n    var s = new Set(selectedCategories);\n    if (s.has(e.target.name)) {\n      s.delete(e.target.name);\n    } else {\n      s.add(e.target.name);\n    }\n    setSelectedCategories(s);\n  }\n  function handleSelectAllCategories(txnomy) {\n    // takes argument instead of using taxonomy directly because taxonomy\n    // state update can lag behind\n    setSelectedCategories(getAllCategories(txnomy));\n  }\n  function handleDeselectAllCategories() {\n    setSelectedCategories(new Set());\n  }\n  function handleSelectCompany(e) {\n    // called when you select from the search bar\n    const selectedCompany = companiesGeojson.features[e.idx];\n    displayPopup(thisMap, selectedCompany);\n    thisMap.flyTo({\n      center: selectedCompany.geometry.coordinates,\n      zoom: 14\n    });\n  }\n  function handleSelectMap(mapId) {\n    // called when you change the mapId\n    console.log(\"I am at: \");\n    console.log(selectedMapId);\n    console.log(\"I clicked: \");\n    console.log(mapId);\n    console.log(thisMap);\n    if (mapId !== selectedMapId) {\n      clearPopups();\n      console.log(\"thisMap: \");\n      console.log(thisMap);\n      if (thisMap) {\n        thisMap.removeLayer(POINT_LAYER);\n        thisMap.removeSource(COMPANIES_SOURCE);\n      }\n      setSelectedMapId(mapId);\n      setMobileDrawerOpen(false);\n      let mapData = fetchMapData(mapId);\n      mapData.then(setUpMap);\n      if (thisMap) {\n        populateMapData(thisMap, mapId, mapData);\n        handleSelectAllCategories(taxonomy);\n      }\n    }\n  }\n  function handleShift() {\n    // called when you open the mobile drawer\n    if (!mobileDrawerOpen) {\n      return classes.mainControlOverlay;\n    } else {\n      return classes.mainControlOverlayShifted;\n    }\n  }\n  function handleReset() {\n    // called when reset button is clicked\n    thisMap.flyTo({\n      center: MAPS[selectedMapId].flyTo,\n      zoom: MAPS[selectedMapId].flyToZoom || 8\n    });\n  }\n  function setUpMap(data) {\n    // changes the data in the map\n    setTaxonomy(data['taxonomy']);\n    setCompaniesGeojson(data['geojson']);\n    // initially select all categories\n    handleSelectAllCategories(data['taxonomy']);\n  }\n\n  //added Jun 28\n  function getDistance(coord1, coord2) {\n    let x = coord1[0] - coord2[0];\n    let y = coord1[1] - coord2[1];\n    return Math.sqrt(x * x + y * y);\n  }\n\n  //added Jun 28\n  function getClosestRegion(clickedCoordinates, MAPS) {\n    let closestRegionId = null;\n    let minDistance = Infinity;\n    Object.keys(MAPS).forEach(mapId => {\n      const distance = getDistance(clickedCoordinates, MAPS[mapId].center);\n      if (distance < minDistance) {\n        minDistance = distance;\n        closestRegionId = mapId;\n      }\n    });\n    console.log(\"closest id: \");\n    console.log(closestRegionId);\n    return closestRegionId;\n  }\n\n  //added Jun 28\n\n  function initMap() {\n    // creates the map\n    let map = new mapboxgl.Map({\n      container: \"map-container\",\n      style: 'mapbox://styles/mapbox/dark-v10',\n      attributionControl: false,\n      center: MAPS[selectedMapId].center,\n      zoom: MAPS[selectedMapId].flyToZoom || 6,\n      minZoom: 2\n    });\n    let mapData = fetchMapData(selectedMapId);\n    mapData.then(setUpMap);\n    map.on('load', () => {\n      map.addControl(new mapboxgl.FullscreenControl(), 'bottom-right');\n      map.addControl(new mapboxgl.NavigationControl(), 'bottom-right');\n      populateMapData(map, selectedMapId, mapData);\n    });\n    //added June 28\n\n    setThisMap(map);\n\n    //map.on('click', mapClickHandlerRef.current);\n  }\n\n  const mapClickHandlerRef = useRef(null);\n  useEffect(() => {\n    if (!thisMap) {\n      initMap();\n    }\n    if (thisMap) {\n      thisMap.on('click', mapClickHandlerRef.current);\n      if (thisMap.getLayer(POINT_LAYER)) {\n        var filters = [\"any\"];\n        // If ANY of the 3 taxonomies for a company are selected, it should be\n        // displayed on the map.\n        [1, 2, 3].forEach(i => {\n          var filter = [\"in\", `tax${i}sanitized`];\n          selectedCategories.forEach(category => filter.push(category));\n          filters.push(filter);\n        });\n        thisMap.setFilter(POINT_LAYER, filters);\n      }\n    }\n  }, [thisMap, selectedCategories]);\n  useEffect(() => {\n    function handleMapClick(e) {\n      // Get clicked point's coordinates\n      const clickedCoordinates = [e.lngLat.lng, e.lngLat.lat];\n\n      // You need a function 'getClosestRegion' that would return the ID of the closest region to the clicked point\n      const closestRegionId = getClosestRegion(clickedCoordinates, MAPS);\n\n      // Call 'handleSelectMap' with the obtained region ID\n      handleSelectMap(closestRegionId);\n    }\n    mapClickHandlerRef.current = handleMapClick;\n  }, [MAPS, handleSelectMap]);\n  useUrlFragment(selectedMapId, urlFragment => {\n    if (MAPS.hasOwnProperty(urlFragment)) {\n      handleSelectMap(urlFragment);\n    }\n  });\n  return /*#__PURE__*/_jsxDEV(ThemeProvider, {\n    theme: THEME,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: classes.root,\n      children: [/*#__PURE__*/_jsxDEV(SettingsPane, {\n        selectedMapId: selectedMapId,\n        mobileDrawerOpen: mobileDrawerOpen,\n        selectedCategories: selectedCategories,\n        onToggleOpen: setMobileDrawerOpen,\n        onSelectMap: handleSelectMap,\n        taxonomy: taxonomy,\n        onSelectAllCategories: () => handleSelectAllCategories(taxonomy),\n        onDeselectAllCategories: handleDeselectAllCategories,\n        onToggleCategory: handleToggleCategory\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 420,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n        className: classes.mainContent,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          id: \"map-container\",\n          className: classes.mapContainer\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 431,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(LogoOverlay, {\n          selectedMapId: selectedMapId\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 432,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: classes.resetViewButton,\n          children: /*#__PURE__*/_jsxDEV(IconButton, {\n            variant: \"contained\",\n            color: \"white\",\n            className: classes.resetViewButton,\n            \"aria-label\": \"reset view\",\n            onClick: () => {\n              handleReset();\n            },\n            children: /*#__PURE__*/_jsxDEV(Home, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 435,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 434,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 433,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: classes.mapOverlay,\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: classes.mapOverlayInner,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: handleShift(),\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: classes.titleAndSearch,\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: classes.mapTitle,\n                  children: /*#__PURE__*/_jsxDEV(Typography, {\n                    variant: \"h1\",\n                    children: MAPS[selectedMapId].title\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 443,\n                    columnNumber: 19\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 442,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(Omnibox, {\n                  companies: companiesGeojson.features,\n                  onSelectCompany: handleSelectCompany,\n                  onOpenMobileDrawer: () => setMobileDrawerOpen(true)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 445,\n                  columnNumber: 17\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 441,\n                columnNumber: 15\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 440,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(LogoOverlay, {\n              selectedMapId: selectedMapId\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 452,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 439,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 438,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 430,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 419,\n      columnNumber: 5\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 418,\n    columnNumber: 3\n  }, this);\n}\n_s2(App, \"egzftaXyFDuswqZcozcOPd/y8uM=\", false, function () {\n  return [useStyles, useUrlFragment];\n});\n_c = App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["mapboxgl","React","useState","useEffect","useRef","ThemeProvider","Hidden","Typography","makeStyles","IconButton","Home","LogoOverlay","Omnibox","SettingsPane","getAllCategories","CONFIG","fetchMapData","THEME","insightLogo","jsxDEV","_jsxDEV","COMPANIES_SOURCE","MAPS","POINT_LAYER","accessToken","getPopupContent","props","categoryInfo","map","k","filter","s","join","extraNotes","hasOwnProperty","clearPopups","popUps","document","getElementsByClassName","remove","displayPopup","feature","coordinates","geometry","slice","Popup","setLngLat","setHTML","properties","setMaxWidth","addTo","populateMapData","mapId","mapData","console","log","setCenter","center","setZoom","then","data","addSource","type","circleColors","c","name","color","flat","concat","addLayer","id","source","interactive","paint","stops","on","e","getCanvas","style","cursor","features","flyTo","zoom","flyToZoom","speed","getUrlFragment","window","location","hash","replace","useUrlFragment","fragment","callback","_s","handleHashChange","addEventListener","removeEventListener","getInitialMapId","initialMapId","useStyles","theme","root","display","flexDirection","mainContent","flexGrow","position","mapContainer","height","top","right","left","bottom","backgroundColor","mapOverlay","padding","pointerEvents","mapOverlayInner","width","margin","mainControlOverlay","mainControlOverlayShifted","marginLeft","insightLogoContainer","marginTop","titleAndSearch","mapTitle","marginBottom","resetViewButton","minWidth","maxWidth","App","_s2","classes","thisMap","setThisMap","selectedMapId","setSelectedMapId","taxonomy","setTaxonomy","companiesGeojson","setCompaniesGeojson","selectedCategories","setSelectedCategories","Set","mobileDrawerOpen","setMobileDrawerOpen","handleToggleCategory","has","target","delete","add","handleSelectAllCategories","txnomy","handleDeselectAllCategories","handleSelectCompany","selectedCompany","idx","handleSelectMap","removeLayer","removeSource","setUpMap","handleShift","handleReset","getDistance","coord1","coord2","x","y","Math","sqrt","getClosestRegion","clickedCoordinates","closestRegionId","minDistance","Infinity","Object","keys","forEach","distance","initMap","Map","container","attributionControl","minZoom","addControl","FullscreenControl","NavigationControl","mapClickHandlerRef","current","getLayer","filters","i","category","push","setFilter","handleMapClick","lngLat","lng","lat","urlFragment","children","className","onToggleOpen","onSelectMap","onSelectAllCategories","onDeselectAllCategories","onToggleCategory","fileName","_jsxFileName","lineNumber","columnNumber","variant","onClick","title","companies","onSelectCompany","onOpenMobileDrawer","_c","$RefreshReg$"],"sources":["/Users/dongwookang/Documents/internship/aes-test/src/App.js"],"sourcesContent":["import mapboxgl from 'mapbox-gl';\nimport React, { useState, useEffect, useRef} from 'react';\nimport { ThemeProvider } from '@material-ui/core/styles';\nimport Hidden from '@material-ui/core/Hidden';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\nimport IconButton from '@material-ui/core/Button';\nimport { Home } from '@material-ui/icons';\nimport LogoOverlay from './LogoOverlay';\nimport Omnibox from './Omnibox';\nimport SettingsPane from './SettingsPane';\nimport { getAllCategories } from './common';\nimport CONFIG from './config.json';\nimport { fetchMapData } from './data-loader';\nimport { THEME } from './Theme';\nimport insightLogo from './img/insight-white.png';\nimport './App.css';\n\nconst COMPANIES_SOURCE = 'companies';\nconst MAPS = CONFIG['maps'];\nconst POINT_LAYER = 'energy-companies-point-layer';\n\n// mapboxgl.accessToken = process.env.REACT_APP_MAPBOX_API_TOKEN;\nmapboxgl.accessToken='pk.eyJ1IjoidG90b3JvLWRha2UiLCJhIjoiY2tiNzJuZmQ3MDFudDJxa2N1ZG91YzBzciJ9.5qJpYzti2W7avnuM9rCiKA'\n\n/** @return {html code for the popup } */\nfunction getPopupContent(props) {\n  const categoryInfo = ['tax1', 'tax2', 'tax3']\n    .map(k => props[k])\n    .filter(s => s).join(\", \");\n  var extraNotes = \"\";\n  if (props.hasOwnProperty(\"notes\") && props[\"notes\"] !== \"\") {\n    extraNotes = `Focus: <span>${props['notes']}</span><br />`;\n  }\n  return `\n    <div class=\"popup\" style = \"color: 626262\">\n      <h3 class=\"company-name\">\n        <a href=${props['website']} class=\"popup-link\" target=\"blank\">${props['company']}</a>\n      </h3>\n      Sector(s): <span class=\"category-info\">${categoryInfo}</span><br />\n      City: <span class=\"city-info\">${props['city']}</span><br />\n      ${extraNotes}\n    </div>`;\n}\n\nfunction clearPopups() {\n  // Check if there is already a popup on the map and if so, remove it\n  // This prevents multiple popups in the case of overlapping circles\n  var popUps = document.getElementsByClassName('mapboxgl-popup');\n  if (popUps[0]) popUps[0].remove();\n}\n\nfunction displayPopup(map, feature) {\n  // clears the open popup and creates the new one \n  const coordinates = feature.geometry.coordinates.slice();\n  clearPopups();\n  new mapboxgl.Popup({})\n    .setLngLat(coordinates)\n    .setHTML(getPopupContent(feature.properties))\n    .setMaxWidth(\"600px\")\n    .addTo(map);\n}\n//79ddf2 - color for hover\n\nfunction populateMapData(map, mapId, mapData) {\n  // adds the data to the map\n  // sets correct initial view of the map\n  console.log(\"map for debug: \")\n  console.log(map)\n  console.log(\"from populateMapData, mapId: \")\n  console.log(MAPS[mapId])\n  map.setCenter(MAPS[mapId].center);\n  map.setZoom(6);\n\n  mapData.then(data => {\n    map.addSource(COMPANIES_SOURCE, {\n      type: 'geojson',\n      data: data['geojson'],\n    });\n\n    // Last entry is fallthrough color\n    let circleColors =\n      data['taxonomy'].map(c => [c.name, c.color]).flat().concat(['#ccc']);\n\n    map.addLayer({\n      id: POINT_LAYER,\n      type: 'circle',\n      source: COMPANIES_SOURCE,\n      interactive: true,\n      paint: {\n        // make circles larger as the user zooms\n        'circle-radius': {\n          stops: [[7, 5], [14, 12], [20, 50]]\n        },\n        'circle-opacity': 0.85,\n        // color circles by primary category\n        'circle-color': ['match', ['get', 'tax1']].concat(circleColors),\n        'circle-stroke-color': '#000',\n        'circle-stroke-width': 0.4,\n      }\n    });\n\n    map.on('mouseenter', POINT_LAYER, (e) => {\n      map.getCanvas().style.cursor = 'pointer';\n    });\n\n    map.on('mouseleave', POINT_LAYER, () => {\n      map.getCanvas().style.cursor = '';\n    });\n\n    map.on('click', POINT_LAYER, e => displayPopup(map, e.features[0]));\n\n    map.flyTo({\n      center: MAPS[mapId].flyTo,\n      zoom: MAPS[mapId].flyToZoom || 8,\n      speed: 0.5,\n    });\n  });\n}\n\nconst getUrlFragment = () => window.location.hash.replace('#', '');\n\nfunction useUrlFragment(fragment, callback) {\n  useEffect(() => {\n    window.location.hash = '#' + fragment;\n    const handleHashChange = () => {\n      callback(getUrlFragment());\n    }\n    window.addEventListener('hashchange', handleHashChange);\n    return () => {\n      window.removeEventListener('hashchange', handleHashChange);\n    }\n  });\n}\n\n/** @return {mapId} */\nfunction getInitialMapId() {\n  let initialMapId = getUrlFragment();\n  if (MAPS.hasOwnProperty(initialMapId)) {\n    return initialMapId;\n  }\n  return CONFIG['defaultMapId'];\n}\n\n// sets the styles for the material-ui components\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    display: 'flex',\n    flexDirection: 'row',\n  },\n  mainContent: {\n    flexGrow: 1,\n    position: 'relative',\n  },\n  mapContainer: {\n    height: '100vh',\n    top: 0,\n    right: 0,\n    left: 0,\n    bottom: 0,\n    backgroundColor: '#333',\n  },\n  mapOverlay: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    right: 0,\n    bottom: 0,\n    padding: 0,\n    pointerEvents: 'none',\n  },\n  mapOverlayInner: {\n    display: 'block',\n    position: 'relative',\n    height: '100%',\n    width: '100%',\n    margin: 0,\n    padding: 0,\n  },\n  mainControlOverlay: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    padding: 0,\n    margin: 0,\n    pointerEvents: 'auto',\n    display: 'flex',\n    flexDirection: 'row',\n  },\n  mainControlOverlayShifted: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    padding: 0,\n    margin: 0,\n    pointerEvents: 'auto',\n    display: 'flex',\n    flexDirection: 'row',\n    marginLeft: 320,\n  },\n  insightLogoContainer: {\n    padding: 8,\n    marginTop: 23,\n    marginLeft: 8,\n  },\n  titleAndSearch: {\n    padding: '4px 8px',\n  },\n  mapTitle: {\n    color: '#fff',\n    padding: '4px 0px',\n    marginBottom: 4,\n  },\n  resetViewButton: {\n    position: 'absolute',\n    bottom: 73,\n    right: 4.5,\n    minWidth: 30,\n    maxWidth: 30,\n    height: 31,\n  }\n}));\n\n/** @return {html code for the app } */\nexport default function App() {\n  const classes = useStyles();\n\n  const [thisMap, setThisMap] = useState(null);\n  const [selectedMapId, setSelectedMapId] = useState(getInitialMapId());\n  const [taxonomy, setTaxonomy] = useState([]);\n  const [companiesGeojson, setCompaniesGeojson] = useState({});\n  const [selectedCategories, setSelectedCategories] = useState(new Set([]));\n  const [mobileDrawerOpen, setMobileDrawerOpen] = useState(false);\n\n\n  function handleToggleCategory(e) {\n    // called when categories are individually changed\n    var s = new Set(selectedCategories);\n    if (s.has(e.target.name)) {\n      s.delete(e.target.name);\n    } else {\n      s.add(e.target.name);\n    }\n    setSelectedCategories(s);\n  }\n\n  function handleSelectAllCategories(txnomy) {\n    // takes argument instead of using taxonomy directly because taxonomy\n    // state update can lag behind\n    setSelectedCategories(getAllCategories(txnomy));\n  }\n\n  function handleDeselectAllCategories() {\n    setSelectedCategories(new Set());\n  }\n\n  function handleSelectCompany(e) {\n    // called when you select from the search bar\n    const selectedCompany = companiesGeojson.features[e.idx];\n    displayPopup(thisMap, selectedCompany);\n    thisMap.flyTo({\n      center: selectedCompany.geometry.coordinates,\n      zoom: 14,\n    });\n  }\n\n  function handleSelectMap(mapId) {\n    // called when you change the mapId\n    console.log(\"I am at: \")\n    console.log(selectedMapId)\n    console.log(\"I clicked: \")\n    console.log(mapId)\n    console.log(thisMap)\n    if (mapId !== selectedMapId) {\n      clearPopups();\n      console.log(\"thisMap: \")\n      console.log(thisMap)\n      if(thisMap) {\n        thisMap.removeLayer(POINT_LAYER);\n        thisMap.removeSource(COMPANIES_SOURCE);\n      }\n      setSelectedMapId(mapId);\n      setMobileDrawerOpen(false);\n      let mapData = fetchMapData(mapId);\n      mapData.then(setUpMap);\n      if(thisMap) {\n        populateMapData(thisMap, mapId, mapData);\n        handleSelectAllCategories(taxonomy);\n      }\n    }\n  }\n\n  function handleShift() {\n    // called when you open the mobile drawer\n    if (!mobileDrawerOpen) {\n      return classes.mainControlOverlay;\n    } else {\n      return classes.mainControlOverlayShifted;\n    }\n  }\n\n  function handleReset() {\n    // called when reset button is clicked\n    thisMap.flyTo({\n      center: MAPS[selectedMapId].flyTo,\n      zoom: MAPS[selectedMapId].flyToZoom || 8,\n    });\n  }\n\n  function setUpMap(data) {\n    // changes the data in the map\n    setTaxonomy(data['taxonomy']);\n    setCompaniesGeojson(data['geojson']);\n    // initially select all categories\n    handleSelectAllCategories(data['taxonomy']);\n  }\n\n  \n   //added Jun 28\n   function getDistance(coord1, coord2) {\n    let x = coord1[0] - coord2[0]\n    let y = coord1[1] - coord2[1]\n    return Math.sqrt(x*x + y*y)\n  }\n  \n  //added Jun 28\n  function getClosestRegion(clickedCoordinates, MAPS) {\n    let closestRegionId = null;\n    let minDistance = Infinity;\n  \n    Object.keys(MAPS).forEach(mapId => {\n      const distance = getDistance(clickedCoordinates, MAPS[mapId].center);\n      if (distance < minDistance) {\n        minDistance = distance;\n        closestRegionId = mapId;\n      }\n    });\n    console.log(\"closest id: \")\n    console.log(closestRegionId)\n    return closestRegionId;\n  }\n  \n  //added Jun 28\n\n  \n  function initMap() {\n    // creates the map\n    let map = new mapboxgl.Map({\n      container: \"map-container\",\n      style: 'mapbox://styles/mapbox/dark-v10',\n      attributionControl: false,\n      center: MAPS[selectedMapId].center,\n      zoom: MAPS[selectedMapId].flyToZoom || 6,\n      minZoom: 2,\n    });\n    let mapData = fetchMapData(selectedMapId);\n    mapData.then(setUpMap);\n\n    map.on('load', () => {\n      map.addControl(new mapboxgl.FullscreenControl(), 'bottom-right');\n      map.addControl(new mapboxgl.NavigationControl(), 'bottom-right');\n      populateMapData(map, selectedMapId, mapData);\n    });\n    //added June 28\n\n    setThisMap(map);\n\n    //map.on('click', mapClickHandlerRef.current);\n  }\n  const mapClickHandlerRef = useRef(null);\n\n  useEffect(() => {\n   \n    if (!thisMap) {\n      initMap();\n    }\n\n    if (thisMap) {\n      thisMap.on('click', mapClickHandlerRef.current);\n\n      if (thisMap.getLayer(POINT_LAYER)) {\n        var filters = [\"any\"];\n        // If ANY of the 3 taxonomies for a company are selected, it should be\n        // displayed on the map.\n        [1, 2, 3].forEach(i => {\n          var filter = [\"in\", `tax${i}sanitized`];\n          selectedCategories.forEach(category => filter.push(category));\n          filters.push(filter);\n        });\n        thisMap.setFilter(POINT_LAYER, filters);\n      }\n    }\n  }, [thisMap, selectedCategories]);\n\n  useEffect(() => {\n    function handleMapClick(e) {\n      // Get clicked point's coordinates\n      const clickedCoordinates = [e.lngLat.lng, e.lngLat.lat];\n  \n      // You need a function 'getClosestRegion' that would return the ID of the closest region to the clicked point\n      const closestRegionId = getClosestRegion(clickedCoordinates, MAPS);\n      \n      // Call 'handleSelectMap' with the obtained region ID\n      handleSelectMap(closestRegionId);\n    }\n\n    mapClickHandlerRef.current = handleMapClick;\n  }, [MAPS, handleSelectMap]);\n\n\n  useUrlFragment(selectedMapId, urlFragment => {\n    if (MAPS.hasOwnProperty(urlFragment)) {\n      handleSelectMap(urlFragment);\n    }\n  });\n\nreturn (\n  <ThemeProvider theme={THEME}>\n    <div className={classes.root}>\n      <SettingsPane\n        selectedMapId={selectedMapId}\n        mobileDrawerOpen={mobileDrawerOpen}\n        selectedCategories={selectedCategories}\n        onToggleOpen={setMobileDrawerOpen}\n        onSelectMap={handleSelectMap}\n        taxonomy={taxonomy}\n        onSelectAllCategories={() => handleSelectAllCategories(taxonomy)}\n        onDeselectAllCategories={handleDeselectAllCategories}\n        onToggleCategory={handleToggleCategory} />\n      <main className={classes.mainContent}>\n        <div id=\"map-container\" className={classes.mapContainer} />\n          <LogoOverlay selectedMapId={selectedMapId} />\n          <div className={classes.resetViewButton} >\n            <IconButton variant=\"contained\" color=\"white\" className={classes.resetViewButton} aria-label=\"reset view\" onClick={() => { handleReset() }} >\n              <Home />\n            </IconButton>\n          </div>\n        <div className={classes.mapOverlay}>\n          <div className={classes.mapOverlayInner}>\n            <div className={handleShift()}>\n              <div className={classes.titleAndSearch}>\n                <div className={classes.mapTitle}>\n                  <Typography variant=\"h1\">{MAPS[selectedMapId].title}</Typography>\n                </div>\n                <Omnibox\n                  companies={companiesGeojson.features}\n                  onSelectCompany={handleSelectCompany}\n                  onOpenMobileDrawer={() => setMobileDrawerOpen(true)} />\n              </div>\n              \n            </div>\n            <LogoOverlay selectedMapId={selectedMapId} />\n          </div>\n        </div>\n      </main>\n    </div>\n  </ThemeProvider>\n); }\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}